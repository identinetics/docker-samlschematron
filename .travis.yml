language: python
python:
  - 3.4

sudo: required
services:
  - docker

before_install:
  - echo "os $OSTYPE, hostname $HOSTNAME"

before_script:
  # git submodule init && git submodule update  # done automaticall by travis
  - cd dscripts && git checkout master && cd ..
  - cp conf.sh.travis conf.sh
  - dscripts/build.sh

script:
  - docker run -u 3000 --name=samlschtron
    -e USERNAME=liveuser -e UID=1000
    rhoerbe/samlschtron /testRunner.sh

after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker push rhoerbe/samlschtron;
    fi
